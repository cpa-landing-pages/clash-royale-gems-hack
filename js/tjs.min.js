!function(e){e.fn.t=function(t,a){return this.each(function(){var n,r,s=a,p=t,d=e(this),l=!1,o="​",c="12qwertyuiop[]asdfghjkl;zxcvbnm,./~!@#$%^&*()_+:1234567890-=op".split([]),u='12qwertzuiopü+asdfghjklöä#<yxcvbnm,.-!"§$%&/(()=?1234567890ß*p+',f=function(t,a){return e.type(t)[0]==(a||"n")},y=function(){return g=e.grep(w,function(e){return"&"==e[0]||!e[1]}).length-1,g>-1?g:0};if(""===p&&(p="<del>*</del>"),d.data("is_typing"))return"pause"==p&&d.data("pause",f(s,"b")?s:!d.data("pause")),this;if("pause"==p)return this;if(d.data("is_typing",1),f(p,"o")&&(s=p),/t\-/.test(d.attr("class")))return this;if("add"==p&&e(".t-container",d)[0]){var h=s,s=e.extend(d.data()),m=d=e(":first",d);h="<"+s.tag+' class="typing-add">'+h+"</"+s.tag+">"}else{"add"==p&&(p=s,s={});var v,w,b,_,$,m,s=e.extend({t:!0,delay:!1,speed:75,speed_vary:!1,caret:"▎",tag:"span",blink:!1,repeat:-3,wrap:!1,mistype:!1,locale:"en",init:e.noop,typing:e.noop,fin:e.noop},s),r=!1,h=!1;e(".t-container",d)[0]||(d.wrapInner(e("<"+s.tag+"/>",{class:"t-container",style:"top:auto;bottom:auto;"})),d.css("position").match(/^[ar]/)||d.css({position:"relative"}),d.css({overflow:"hidden"})),s.wrap&&!d.parent().data("t-wrap")&&(d.wrap(e("<div/>",s.wrap[0].match(/[.#]/)?"#"==s.wrap[0]?{id:s.wrap.substr(1)}:{class:s.wrap.substr(1)}:{style:s.wrap})),d.parent().data("t-wrap",1)),f(s.caret,"s")&&!e(".t-caret",d)[0]&&(f(s.blink)&&s.blink<10&&(s.blink=10),r=e("<"+s.tag+"/>",{class:"t-caret",html:s.caret}).appendTo(d),s.blink&&d.append(o)&&(_=setInterval(function(){r.toggle()},f(s.blink)?s.blink:s.speed*(s.speed_vary?4:5)))),s.blink||clearInterval(_),s.speed=!f(s.speed)||s.speed<10?10:s.speed,s.speed_vary&&(s.speed/=2.5),s.mistype>1||(s.mistype=!1),d.data(s),e(".typing-0",d).replaceWith(function(){return this.childNodes}),e(".typing-add",d).remove(),m=d=e(":first",d),w=f(p,"s")?p:d.html(),""==w&&(w=o),d.empty(),m.parent().show().css({visibility:"visible"}),f(s.delay)&&s.delay>0&&(v=~~(1e3*s.delay/s.speed))}w=String(h||w).replace(/(.*?)[\u200b]+$/,"$1").replace(/<\!\-\-([\s\S]+?)\-\->/g,"$1").replace(/<ins><\/ins>/g,"").replace(/<(img|br|input|hr)(.*?)[\/]?>/g,"<#$1$2/>").replace(/<ins>\s*(\d+[.]?\d{0,})\s*<\/ins>/g,'<ins data-ins="$1"></ins>').replace(/<ins>([\s\S]+?)<\/ins>/g,function(e,t){return"<#ins>"+t.replace(/<[^#]/g,"<#")+"</ins>"}).replace(/<(del.*?data-del=")(.*?)(".*?)><\/(del>)/g,"<#$1$2$3><#/$4$2<#/$4").replace(/<del(.*?)>([\s\S]*?)<\/del>/g,function(e,t,a,n){return i=a.match(/data-ins=\"(.*?)\"/),i=i&&i[1]?i[1]:.25,a=a.replace(/<[\/]?.*?>/g,""),"<del"+t+' data-del="'+a.replace(/\n/,"\\n")+'" data-ins="'+i+'">'+("*"!=a?a:"")+"</del>"}).replace(/<(\w+)(.*?)>/g,"<$1$2></$1>").replace(/<#/g,"<").match(/<ins>[\s\S]+?<\/ins>|<[^<]+\/>|<\/\w+>|<[\s\S]+?><\/\w+>|&[#x]?[a-z0-9]+;|\r|\n|\t|\S|\s/gi),!f(v)&&(v=w.shift()),w.push(o),"de"==s.locale&&(c=u),b=y(),!h&&s.init(m.parent()),$=setInterval(function(){if(!m.parent().data("pause")&&!l){if(l=!l,f(v)){if(--v)return void(l=!l);v=d.data().ins?"//":w.shift()}else if(s.speed_vary&&~~(4*Math.random()))return void(l=!l);if(d.data().del&&(n=String(d.data().del),!f(v,"a")&&"/"==v[1]&&(v=n.replace(/\\n/g,"\n").split([])),f(v,"a"))){if(v.pop())return d.text(v.join([])),void(l=!l);"*"==n&&(m.wrapInner(e("<"+s.tag+"/>",{class:"typing-0",style:"display:none;"})),d=d.parent(),h&&(w=e.merge(["<"+s.tag+' class="typing-add"></'+s.tag+">"],w,["</"+s.tag+">"]),d=d.parent())),d=d.parent(),n==o&&d.find(":last").remove(),v=""}for(;"/"==v[1];)d=d.parent(),v=w.shift()||"";if(d.append(v),s.typing(m.parent(),y(),b,v),!v.match(/<ins>/)&&v.match(/></)&&(d=d.find(":last")),!(v=w.shift()))return clearInterval($),m.parent().removeData(["is_typing","pause"]),f(s.repeat)&&--s.repeat,s.repeat>-1?(s.init=e.noop,void m.parent().t(f(p,"o")?s:p,s)):void s.fin(m.parent());s.mistype&&v&&!v[1]&&d.data().del!=o&&" "!=v&&!~~(Math.random()*s.mistype)&&(__=e.inArray(v.toLowerCase(),c,2))>-1&&(__+=~~(2*Math.random())+1,~~(2*Math.random())&&(__-=3),w=e.merge([v.charCodeAt(0)<90?c[__].toUpperCase():c[__],"</del>",v],w),v='<del data-ins="0.25" data-del="'+o+'"></del>'),v&&"/"==v[1]&&d.data().ins&&(v=~~(1e3*Number(d.data().ins)/s.speed)),l=!l}},s.speed)})}}(jQuery);